<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘¨æ˜“ AI éˆå¦ - å®Œæ•´ 64 å¦ç‰ˆ</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap');
        body { font-family: 'Noto Serif TC', serif; }
        .animate-in { animation: fadeIn 0.5s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // å®Œæ•´ 64 å¦è³‡æ–™åº« (0: é™°, 1: é™½)
        const HEXAGRAM_MAP = {
            "111111": { name: "ä¹¾ç‚ºå¤©", trait: "å‰›å¥ä¸­æ­£", meaning: "å¤§å‰ã€‚è±¡å¾µå¤©ä¹‹é‹è¡Œï¼Œå‰›å¥ä¸æ¯ã€‚æ­¤å¦åˆ©æ–¼é€²å–ï¼Œè±¡å¾µæ¥µå¤§çš„æˆåŠŸæ½›åŠ›ã€‚" },
            "000000": { name: "å¤ç‚ºåœ°", trait: "æŸ”é †åŒ…å®¹", meaning: "å‰ã€‚è±¡å¾µå¤§åœ°ä¹‹åšå¾·ã€‚å®œå®ˆä¸å®œæ”»ï¼Œå¾…äººä»¥å¯¬ï¼Œåšå¾·è¼‰ç‰©ã€‚" },
            "100010": { name: "æ°´é›·å±¯", trait: "è¬äº‹èµ·é ­é›£", meaning: "åˆç”Ÿä¹‹è±¡ã€‚å……æ»¿å›°é›£ä½†å¯Œæœ‰ç”Ÿå‘½åŠ›ï¼Œå®œå …å®šæ„å¿—ï¼Œä¸å®œè¼•èˆ‰å¦„å‹•ã€‚" },
            "010001": { name: "å±±æ°´è’™", trait: "å•Ÿè’™æ•™è‚²", meaning: "è’™æ˜§ç™¼ç¾ã€‚è±¡å¾µè™•æ–¼å­¸ç¿’éšæ®µï¼Œéœ€è¦å°å¸«æŒ‡å¼•ï¼Œå¾…æ™‚è€Œå‹•ã€‚" },
            "111010": { name: "æ°´å¤©éœ€", trait: "å®ˆæ™‚å¾…å‘½", meaning: "éœ€è€…ï¼Œå¾…ä¹Ÿã€‚æ™‚æ©Ÿå°šæœªæˆç†Ÿï¼Œæ‡‰è€å¿ƒç­‰å¾…ï¼Œè“„å‹¢å¾…ç™¼ã€‚" },
            "010111": { name: "å¤©æ°´è¨Ÿ", trait: "çˆ­ç«¯ç”³è¨´", meaning: "æ…é˜²çˆ­è¨Ÿã€‚èˆ‡äººä¸å’Œä¹‹è±¡ï¼Œå®œé€€è®“ä¸€æ­¥ï¼Œå†¤å®¶å®œè§£ä¸å®œçµã€‚" },
            "010000": { name: "åœ°æ°´å¸«", trait: "èˆˆå¸«å‹•çœ¾", meaning: "çµ±ç‡çœ¾äººã€‚éœ€æœ‰ç´€å¾‹èˆ‡æ­£ç¾©ï¼Œæ–¹èƒ½å…‹æ•µè‡´å‹ã€‚" },
            "000010": { name: "æ°´åœ°æ¯”", trait: "è¦ªæ¯”ç›¸ä¾", meaning: "å‰ã€‚è±¡å¾µè¼”åŠ©ã€å’Œè«§ã€åœ˜çµï¼Œåˆ©æ–¼å°‹æ±‚åˆä½œå¤¥ä¼´ã€‚" },
            "111011": { name: "é¢¨å¤©å°ç•œ", trait: "å¾®å°è“„ç©", meaning: "åŠ›é‡å°šå¾®ã€‚ç›®å‰åªèƒ½å°æœ‰æˆå°±ï¼Œéœ€ç¹¼çºŒç©ç´¯ï¼Œä¸å¯æ“ä¹‹éæ€¥ã€‚" },
            "110111": { name: "å¤©æ¾¤å±¥", trait: "å¦‚å±¥è–„å†°", meaning: "è™•å¢ƒè‰±é›£ã€‚å¦‚è¸©åœ¨è€è™å°¾å·´ä¸Šï¼Œéœ€æ¥µåº¦è¬¹æ…ã€å®ˆç¦®æ–¹å¯è„«éšªã€‚" },
            "111000": { name: "åœ°å¤©æ³°", trait: "å¤©åœ°äº¤æ³°", meaning: "å¤§å‰ã€‚é™°é™½äº¤èï¼Œè¬äº‹äº¨é€šï¼Œé©åˆç™¼å±•å¤§äº‹æ¥­ã€‚" },
            "000111": { name: "å¤©åœ°å¦", trait: "é–‰å¡ä¸é€š", meaning: "å‡¶ã€‚å°äººå¾—å¿—ï¼Œæ­£é“è¡°å¾®ã€‚æ­¤æ™‚å®œå®ˆå¿—ï¼Œä¸å®œå¼µæšã€‚" },
            "101111": { name: "å¤©ç«åŒäºº", trait: "å¿—åŒé“åˆ", meaning: "å¤§åŒä¸–ç•Œã€‚åˆ©æ–¼é›†é«”è¡Œå‹•ï¼Œèˆ‡äººåˆä½œç„¡å¾€ä¸åˆ©ã€‚" },
            "111101": { name: "ç«å¤©å¤§æœ‰", trait: "å¯Œç²å¤§æœ‰", meaning: "å¦‚æ—¥ä¸­å¤©ã€‚è³‡æºå……è¶³ï¼Œæ°£é‹æ¥µæ—ºï¼Œä½†éœ€è¬™è™›å®ˆæˆã€‚" },
            "000100": { name: "åœ°å±±è¬™", trait: "è¬™è¬™å›å­", meaning: "å‰ã€‚è¬™è™›å¿…ç²ç›Šã€‚å³ä¾¿èº«è™•é«˜ä½ä¹Ÿæ‡‰ä¿æŒä½èª¿ã€‚" },
            "001000": { name: "é›·åœ°è±«", trait: "å–œæ‚…é å‚™", meaning: "æ‚…ä¹Ÿã€‚åˆ©æ–¼å»ºåŠŸç«‹æ¥­ï¼Œæ‡‰é †å‹¢è€Œç‚ºï¼Œæå‰åšå¥½è¦åŠƒã€‚" },
            "100110": { name: "æ¾¤é›·éš¨", trait: "éš¨é‡è€Œå®‰", meaning: "éš¨æ©Ÿæ‡‰è®Šã€‚é †å¾æ½®æµï¼Œä¸å›ºåŸ·å·±è¦‹ï¼Œå‰‡èƒ½äº¨é€šã€‚" },
            "011001": { name: "å±±é¢¨è ±", trait: "æ•´é£­å¼Šç«¯", meaning: "è…æ•—ä¹‹è±¡ã€‚éœ€è¦å¤§è†½æ”¹é©ï¼Œæƒé™¤é™³ç–¾ï¼Œæ–¹æœ‰æ–°ç”Ÿã€‚" },
            "110000": { name: "åœ°æ¾¤è‡¨", trait: "å›è‡¨å¤©ä¸‹", meaning: "å¤§å‰ã€‚å¥½é‹å³å°‡ä¾†è‡¨ï¼Œä½†è¦é˜²ç¯„ç››æ¥µè€Œè¡°ã€‚" },
            "000011": { name: "é¢¨åœ°è§€", trait: "éœè§€å…¶è®Š", meaning: "è§€å¯Ÿé ˜æ‚Ÿã€‚ä¸å®œèºé€²ï¼Œæ‡‰éœå¿ƒè§€å¯Ÿå±€å‹¢ï¼Œæå‡è‡ªæˆ‘ã€‚" },
            "100101": { name: "ç«é›·å™¬å—‘", trait: "æ’é™¤éšœç¤™", meaning: "å‰›æ¯…ã€‚è±¡å¾µåŸ·æ³•ã€æ–·æ˜¯éï¼Œéœ€æœæ–·æ’é™¤é˜»ç¤™äº‹æ¥­çš„éšœç¤™ã€‚" },
            "101001": { name: "å±±ç«è³", trait: "è£é£¾ç¾åŒ–", meaning: "æ–‡é£¾ã€‚è±¡å¾µå¤–è¡¨è¯éº—ä½†å¯¦è³ªå¯èƒ½ä¸è¶³ï¼Œå®œå……å¯¦å…§åœ¨ã€‚" },
            "000001": { name: "å±±åœ°å‰", trait: "å‰è½è¡°æ•—", meaning: "å‡¶ã€‚å°äººå‹¢ç››ï¼Œå›å­å›°é “ã€‚å®œéš±å¿å¾…æ™‚ï¼Œä¸å¯å¼·å‡ºé ­ã€‚" },
            "100000": { name: "åœ°é›·å¾©", trait: "ä¸€é™½å¾©å§‹", meaning: "è½‰æ©Ÿã€‚é»‘æš—å·²éï¼Œæ›™å…‰åˆç¾ã€‚åˆ©æ–¼é‡æ–°é–‹å§‹æ–°è¨ˆç•«ã€‚" },
            "100111": { name: "å¤©é›·ç„¡å¦„", trait: "çœŸèª ç„¡å¦„", meaning: "é †å…¶è‡ªç„¶ã€‚ä¸å¯æœ‰éåˆ†ä¹‹æƒ³ï¼Œå®ˆæ­£å‰‡å‰ï¼ŒæŠ•æ©Ÿå‰‡å‡¶ã€‚" },
            "111001": { name: "å±±å¤©å¤§ç•œ", trait: "å¤§é‡å„²å‚™", meaning: "å¤§æœ‰ç©è“„ã€‚å®œå­¸ç¿’ã€å……å¯¦èƒ½åŠ›ï¼Œåˆ©æ–¼æ‰¿æ“”é‡ä»»ã€‚" },
            "100001": { name: "å±±é›·é ¤", trait: "é ¤é¤Šå¤©å¹´", meaning: "é¤Šèº«è™•ä¸–ã€‚æ³¨æ„è¨€èªèˆ‡é£²é£Ÿï¼Œè§€å¯Ÿå¦‚ä½•è‡ªé£Ÿå…¶åŠ›ã€‚" },
            "011110": { name: "æ¾¤é¢¨å¤§é", trait: "è² æ“”éé‡", meaning: "å£“åŠ›å·¨å¤§ã€‚è±¡å¾µè¡Œå‹•è¶…éè² è·ï¼Œéœ€æœ‰éå¸¸æ‰‹æ®µæ‰èƒ½è„«å›°ã€‚" },
            "010010": { name: "åç‚ºæ°´", trait: "é‡é‡éšªé›£", meaning: "å‡¶ã€‚éšªä¸­ä¹‹éšªã€‚éœ€ä¿æŒèª ä¿¡ï¼Œå…§å¿ƒå®‰å®šæ–¹èƒ½åº¦éé›£é—œã€‚" },
            "101101": { name: "é›¢ç‚ºç«", trait: "æ˜äº®ä¾é™„", meaning: "å‰ã€‚è±¡å¾µæ™ºæ…§ã€å…‰æ˜ã€‚éœ€ä¾é™„æ­£é“ï¼Œå‰‡å‰ç¨‹ä¼¼éŒ¦ã€‚" },
            "011100": { name: "æ¾¤å±±å’¸", trait: "å¿ƒéˆæ„Ÿæ‡‰", meaning: "äº¨ã€‚è±¡å¾µç”·å¥³ã€äººéš›é–“çš„å’Œè«§äº¤æµï¼Œèª æ„æ–¹èƒ½æ„Ÿäººã€‚" },
            "001110": { name: "é›·é¢¨æ†", trait: "æŒä¹…ä¸è®Š", meaning: "æ†å¿ƒã€‚é•·ä¹…å …æŒæ­£é“ã€‚ä¸å®œè®Šå‹•ï¼Œç©©å®šä¸­æ±‚ç™¼å±•ã€‚" },
            "001111": { name: "å¤©å±±é¯", trait: "éš±é€€é¿ç¦", meaning: "é€€é¿ã€‚å°äººå‹¢é•·ï¼Œå®œåŠæ—©æŠ½èº«ï¼Œé é›¢æ˜¯éä¹‹åœ°ã€‚" },
            "111100": { name: "é›·å¤©å¤§å£¯", trait: "è²å‹¢æµ©å¤§", meaning: "å£¯å¤§ã€‚åŠ›é‡å¼·ç››ï¼Œä½†è¦æ³¨æ„ä¸å¯æƒå¼·å‡Œå¼±ï¼Œé˜²èºé€²ã€‚" },
            "000101": { name: "ç«åœ°æ™‰", trait: "å¦‚æ—¥æ–¹å‡", meaning: "å¤§å‰ã€‚è±¡å¾µç²å¾—é‡ç”¨ã€æ™‰å‡ï¼Œäº‹æ¥­é€²å…¥å¿«é€Ÿç™¼å±•æœŸã€‚" },
            "101000": { name: "åœ°ç«æ˜å¤·", trait: "å…‰æ˜å—æ", meaning: "è‰±é›£ã€‚è±¡å¾µé»‘æš—ç± ç½©ï¼Œæ‡‰å…§æ˜å¤–æŸ”ï¼Œéš±è—é‹’èŠ’ä»¥è‡ªä¿ã€‚" },
            "101011": { name: "é¢¨ç«å®¶äºº", trait: "æ²»å®¶æœ‰æ–¹", meaning: "å®‰å®šã€‚è±¡å¾µå…§éƒ¨å’Œè«§ï¼Œåˆ©æ–¼å¾å…§éƒ¨å»ºç«‹ç§©åºã€‚" },
            "110101": { name: "ç«æ¾¤ç½", trait: "ä¹–é›¢ç•°è¦‹", meaning: "èƒŒé›¢ã€‚æ„è¦‹ä¸åˆï¼Œé›£ä»¥åˆä½œã€‚æ­¤æ™‚å°äº‹å¯æˆï¼Œå¤§äº‹é›£å°±ã€‚" },
            "010100": { name: "æ°´å±±è¹‡", trait: "èˆ‰æ­¥ç¶­è‰±", meaning: "å‡¶ã€‚å‰æœ‰å¤§æ°´å¾Œæœ‰å±±ã€‚å®œæ­¢ä¸å®œé€²ï¼Œå°‹æ±‚è²´äººå¹«åŠ©ã€‚" },
            "001010": { name: "é›·æ°´è§£", trait: "è§£è„«å›°å¢ƒ", meaning: "å›°é›£æ¶ˆæ•£ã€‚å±æ©Ÿå·²éï¼Œå®œå¿«åˆ€æ–¬äº‚éº»ï¼Œä¸å®œçŒ¶è±«ã€‚" },
            "110001": { name: "å±±æ¾¤æ", trait: "æ¸›æè‡ªçœ", meaning: "æå·±åˆ©äººã€‚è±¡å¾µèª ä¿¡èˆ‡å…‹å·±ï¼ŒçŸ­æœŸæå¤±å¯èƒ½æ›ä¾†é•·æœŸå›å ±ã€‚" },
            "100011": { name: "é¢¨é›·ç›Š", trait: "ç²ç›Šå¢é•·", meaning: "å¤§å‰ã€‚åˆ©æ–¼é è¡Œã€å‰µæ¥­ã€‚æ­£æ˜¯ç©æ¥µè¡Œå‹•çš„å¤§å¥½æ™‚æ©Ÿã€‚" },
            "111110": { name: "æ¾¤å¤©å¤¬", trait: "æœæ–·æ±ºè£‚", meaning: "æ±ºæ–·ã€‚å¿…é ˆå …æ±ºæ¸…é™¤å°äººæˆ–é˜»ç¤™ï¼Œä½†è¦é˜²æ­¢æš´åŠ›ã€‚" },
            "011111": { name: "å¤©é¢¨å§¤", trait: "æ„å¤–ç›¸é‡", meaning: "é˜²ç¯„ã€‚é™°é•·é™½æ¶ˆä¹‹è±¡ï¼Œè¦æ³¨æ„ä¸å¯å¿½è¦–å¾®å°çš„å¨è„…ã€‚" },
            "000011": { name: "æ¾¤åœ°èƒ", trait: "èšé›†ç²¾è¯", meaning: "å‰ã€‚äººæ‰èšé›†ï¼Œåˆ©æ–¼é›†é«”è¡Œå‹•ã€‚éœ€é˜²å‚™çªç™¼çš„æ··äº‚ã€‚" },
            "110000": { name: "åœ°é¢¨å‡", trait: "ç©©æ­¥ä¸Šå‡", meaning: "å‰ã€‚å¦‚æ¤ç‰©ç”Ÿé•·ï¼Œåˆ©æ–¼æ±‚åæ±‚è·ï¼Œå¾ªåºæ¼¸é€²å¿…æœ‰æ‰€æˆã€‚" },
            "011010": { name: "æ¾¤æ°´å›°", trait: "å›°é “æ™æ‰", meaning: "çª®å›°ã€‚é™·å…¥åƒµå±€ï¼Œè¨€èªç„¡ä¿¡ã€‚æ­¤æ™‚æ‡‰å®ˆæ­£ï¼Œä¿®é¤Šå¿ƒæ€§ã€‚" },
            "010110": { name: "æ°´é¢¨äº•", trait: "æºé æµé•·", meaning: "ä¿®èº«ã€‚è±¡å¾µè³‡æºç©©å®šä½†éœ€ç¶­è­·ï¼Œåˆ©æ–¼æ”¹å–„åŸºç¤å»ºè¨­ã€‚" },
            "101110": { name: "æ¾¤ç«é©", trait: "è®Šé©æ”¹æ–°", meaning: "æ”¹è®Šã€‚èˆŠæœ‰çš„æ–¹å¼å·²è¡Œä¸é€šï¼Œå¿…é ˆå¤§è†½é©æ–°æ–¹æœ‰ç”Ÿè·¯ã€‚" },
            "011101": { name: "ç«é¢¨é¼", trait: "å»ºç«‹æ–°æ”¿", meaning: "å¤§å‰ã€‚è±¡å¾µé¼æ–°ã€ç²å¾—æ”¿æ¬Šæˆ–é ˜å°åœ°ä½ï¼Œç™¼å±•é †åˆ©ã€‚" },
            "001001": { name: "éœ‡ç‚ºé›·", trait: "éœ‡é©šè­¦é†’", meaning: "äº¨ã€‚é›–æœ‰é©šé›·ä½†ä¸å¿…ææ‡¼ï¼Œæ‡‰åçœè‡ªä¿®ï¼ŒåŠ å¼·æˆ’å‚™ã€‚" },
            "100100": { name: "è‰®ç‚ºå±±", trait: "éœæ­¢ç©©é‡", meaning: "æ­¢ä¹Ÿã€‚ä¸å®œèºé€²ï¼Œæ‡‰å®‰æ–¼ç¾ç‹€ï¼Œè‡ªæˆ‘å…‹åˆ¶ã€‚" },
            "001011": { name: "é¢¨å±±æ¼¸", trait: "å¾ªåºæ¼¸é€²", meaning: "å‰ã€‚å¥³æ­¸ä¹‹å‰ã€‚è±¡å¾µæ­¥æ­¥ç‚ºç‡Ÿï¼ŒæŒä¹‹ä»¥æ†å¿…æœ‰çµæœã€‚" },
            "110100": { name: "é›·æ¾¤æ­¸å¦¹", trait: "æœ¬æœ«å€’ç½®", meaning: "å‡¶ã€‚è¡Œç‚ºä¸ç•¶ï¼Œè™•æ–¼å¾å±¬åœ°ä½ã€‚ä¸å®œé€²è¡Œé•·é è¦åŠƒã€‚" },
            "001101": { name: "é›·ç«è±", trait: "ç››å¤§è±ç¢©", meaning: "äº¨ã€‚å¦‚æ—¥ä¸­å¤©ï¼Œä½†è¦é˜²æ­¢æ—¥ä¸­å‰‡æ˜ƒï¼ŒåŠæ—©ç‚ºè¡°é€€åšæº–å‚™ã€‚" },
            "101100": { name: "ç«å±±æ—…", trait: "å®¢å±…ä»–é„‰", meaning: "æ¼‚æ³Šã€‚è±¡å¾µä¸å®‰å®šã€æ—…è¡Œã€‚æ‡‰å®ˆæœ¬åˆ†ï¼Œä¸å¯èˆ‡äººçˆ­åŸ·ã€‚" },
            "011011": { name: "å·½ç‚ºé¢¨", trait: "é †å¾æ·±å…¥", meaning: "è¬™éœã€‚åˆ©æ–¼æ·±å…¥äº†è§£äº‹æƒ…çœŸç›¸ï¼Œé©åˆæ–‡è·å·¥ä½œã€‚" },
            "110110": { name: "å…Œç‚ºæ¾¤", trait: "å–œæ‚…äº¤æµ", meaning: "å‰ã€‚è±¡å¾µå¿«æ¨‚ã€è«‡è©±ã€‚åˆ©æ–¼äº¤éš›ï¼Œä½†è¦é˜²ç¯„å£èˆŒæ˜¯éã€‚" },
            "010011": { name: "é¢¨æ°´æ¸™", trait: "æ¸™æ•£é›¢å¿ƒ", meaning: "æ•´åˆã€‚äººå¿ƒæ¸™æ•£ï¼Œéœ€è¦ç”¨å¼·å¤§çš„å®—æ•™æˆ–ç²¾ç¥åŠ›é‡ä¾†åœ˜çµã€‚" },
            "110010": { name: "æ°´æ¾¤ç¯€", trait: "ç¯€åˆ¶é©åº¦", meaning: "ç¯€åˆ¶ã€‚éåº¦ç¯€åˆ¶æœƒç—›è‹¦ï¼Œä¸ç¯€åˆ¶æœƒæ½°æ•—ï¼Œéœ€å–å¹³è¡¡é»ã€‚" },
            "110011": { name: "é¢¨æ¾¤ä¸­å­š", trait: "èª ä¿¡æ„Ÿäºº", meaning: "å‰ã€‚å…§å¿ƒèª å¯¦ï¼Œç”šè‡³èƒ½æ„ŸåŒ–è±šé­šã€‚åˆ©æ–¼è«‡åˆ¤èˆ‡å»ºç«‹ä¿¡è³´ã€‚" },
            "001100": { name: "é›·å±±å°é", trait: "ç¨æœ‰éåº¦", meaning: "å°äº‹å‰ã€‚æ‡‰æ¡å–ä¿å®ˆç­–ç•¥ï¼Œå‘ä¸‹çœ‹è€Œéå‘ä¸Šçœ‹ï¼Œå®œå®ˆã€‚" },
            "101010": { name: "æ°´ç«æ—¢æ¿Ÿ", trait: "å¤§åŠŸå‘Šæˆ", meaning: "äº¨ã€‚äº‹æƒ…å·²ç¶“åœ“æ»¿ï¼Œä½†è¦æ¥µåº¦é˜²ç¯„ç‰©æ¥µå¿…åã€‚" },
            "010101": { name: "ç«æ°´æœªæ¿Ÿ", trait: "å°šæœªæˆåŠŸ", meaning: "å¸Œæœ›ã€‚é»æ˜å‰çš„é»‘æš—ã€‚åªè¦å …æŒåˆ°åº•ï¼Œçµ‚èƒ½æˆåŠŸã€‚" }
        };

        const App = () => {
            const [question, setQuestion] = useState('');
            const [step, setStep] = useState(0); 
            const [currentLines, setCurrentLines] = useState([]);
            const [isRolling, setIsRolling] = useState(false);
            const [aiAnalysis, setAiAnalysis] = useState('');
            const [isAnalysing, setIsAnalysing] = useState(false);

            const rollCoins = () => {
                if (step !== 1 || currentLines.length >= 6 || isRolling) return;
                setIsRolling(true);
                setTimeout(() => {
                    // æ¨¡æ“¬é‡‘éŒ¢å¦ (ä¸‰æšç¡¬å¹£)
                    const coins = [Math.random() > 0.5, Math.random() > 0.5, Math.random() > 0.5];
                    const headCount = coins.filter(Boolean).length;
                    
                    // 3æ­£(è€é™½:9), 0æ­£(è€é™°:6), 2æ­£(å°‘é™°:8), 1æ­£(å°‘é™½:7)
                    let res;
                    if (headCount === 3) res = 9;
                    else if (headCount === 0) res = 6;
                    else if (headCount === 2) res = 8;
                    else res = 7;

                    setCurrentLines(prev => [...prev, res]);
                    setIsRolling(false);
                }, 600);
            };

            useEffect(() => {
                if (currentLines.length === 6) {
                    setStep(2);
                }
            }, [currentLines]);

            const getGuaCode = (type) => {
                return currentLines.map(line => {
                    if (type === 'original') return (line === 7 || line === 9) ? '1' : '0';
                    if (type === 'changed') return (line === 6 || line === 7) ? '1' : '0';
                    return '0';
                }).join('');
            };

            const originalCode = getGuaCode('original');
            const changedCode = getGuaCode('changed');
            const originalGua = HEXAGRAM_MAP[originalCode] || { name: "ç¥ç¥•å¦è±¡", trait: "ç„å¥§", meaning: "å¦è±¡ç½•è¦‹ï¼Œè«‹æŸ¥é–±å°ˆæ¥­ç¶“ç±ã€‚" };
            const changedGua = HEXAGRAM_MAP[changedCode] || { name: "ç¥ç¥•å¦è±¡", trait: "ç„å¥§", meaning: "æœªä¾†è®Šå¹»è«æ¸¬ã€‚" };

            const fetchAIAnalysis = async () => {
                setIsAnalysing(true);
                const apiKey = "AIzaSyA5Jd5qki8m_Acvy12np6YSNuiUbHyz1Fk"; // æ­¤è™•ç•™ç©ºï¼Œä½¿ç”¨è€…å¯è‡ªè¡Œå¡«å…¥
                
                if (!apiKey) {
                    setTimeout(() => {
                        setAiAnalysis(`ã€å¤§å¸«ç°¡è©•ã€‘\næœ¬å¦ç‚ºã€Š${originalGua.name}ã€‹ï¼Œä»£è¡¨æ‚¨ç›®å‰çš„è™•å¢ƒæ˜¯ã€Œ${originalGua.trait}ã€ã€‚\nè‹¥æ˜¯æ­¤äº‹æœ‰æ‰€è®Šå‹•ï¼Œå°‡è½‰å‘ã€Š${changedGua.name}ã€‹ä¹‹å‹¢ã€‚\n\nğŸ’¡ å»ºè­°ï¼š${originalGua.meaning}\n\n(æç¤ºï¼šè‹¥è¦ç²å¾—æ›´ç²¾ç¢ºçš„ AI æ·±åº¦å»ºè­°ï¼Œè«‹åœ¨åŸå§‹ç¢¼ä¸­å¡«å…¥ Gemini API Key)`);
                        setIsAnalysing(false);
                    }, 1500);
                    return;
                }
                
                // ... AI Fetch logic ...
                try {
                    const systemPrompt = "ä½ æ˜¯ä¸€ä½ç²¾é€šæ˜“ç¶“çš„è§£å¦å¤§å¸«ã€‚è«‹é‡å°ä½¿ç”¨è€…çš„å•é¡Œèˆ‡å¦è±¡çµ¦å‡ºå…·é«”å»ºè­°ã€‚";
                    const userPrompt = `å•é¡Œï¼š${question}\næœ¬å¦ï¼š${originalGua.name}\nè®Šå¦ï¼š${changedGua.name}\nå¦è¾­ï¼š${originalGua.meaning}`;
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: userPrompt }] }], systemInstruction: { parts: [{ text: systemPrompt }] } })
                    });
                    const data = await response.json();
                    setAiAnalysis(data.candidates?.[0]?.content?.parts?.[0]?.text || "å¤©æ©Ÿé›£æ¸¬ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚");
                } catch (e) {
                    setAiAnalysis("åˆ†æéç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤ã€‚");
                } finally { setIsAnalysing(false); }
            };

            useEffect(() => { if (step === 2) fetchAIAnalysis(); }, [step]);

            const renderLine = (val, isResult = false) => {
                const isYang = (val === 7 || val === 9);
                const isMoving = (val === 6 || val === 9);
                return (
                    <div className="flex items-center justify-center gap-1 w-32 h-4 mb-2 relative group">
                        {isYang ? (
                            <div className={`w-full h-full bg-slate-800 rounded-sm ${isMoving && !isResult ? 'ring-2 ring-red-400' : ''}`} />
                        ) : (
                            <React.Fragment>
                                <div className={`w-[45%] h-full bg-slate-800 rounded-sm ${isMoving && !isResult ? 'ring-2 ring-red-400' : ''}`} />
                                <div className={`w-[45%] h-full bg-slate-800 rounded-sm ${isMoving && !isResult ? 'ring-2 ring-red-400' : ''}`} />
                            </React.Fragment>
                        )}
                        {isMoving && !isResult && <div className="absolute -right-6 text-red-500 font-bold">Ã—</div>}
                    </div>
                );
            };

            return (
                <div className="min-h-screen p-4 md:p-8 flex items-center justify-center">
                    <div className="max-w-2xl w-full bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-200">
                        <div className="bg-slate-900 text-white p-8 text-center">
                            <h1 className="text-4xl font-bold tracking-[0.2em] mb-2">å‘¨æ˜“éˆå¦</h1>
                            <p className="text-slate-400 text-sm italic">AI è¼”åŠ©è§£å¦ç³»çµ±</p>
                        </div>

                        <div className="p-8 md:p-12">
                            {step === 0 && (
                                <div className="space-y-8 text-center animate-in">
                                    <h2 className="text-xl font-medium text-slate-700">å¿ƒä¸­é»˜æƒ³å•é¡Œï¼Œè‡³èª æ„Ÿé€š</h2>
                                    <textarea 
                                        className="w-full p-5 border-2 border-slate-100 rounded-2xl focus:border-slate-900 focus:ring-0 outline-none transition-all text-lg"
                                        rows="3"
                                        placeholder="ä¾‹å¦‚ï¼šæˆ‘æœ€è¿‘çš„è²¡é‹å¦‚ä½•ï¼Ÿ"
                                        value={question}
                                        onChange={(e) => setQuestion(e.target.value)}
                                    />
                                    <button 
                                        onClick={() => question.trim() && setStep(1)}
                                        className="bg-slate-900 text-white w-full py-4 rounded-xl hover:bg-slate-800 font-bold text-lg transition-all transform hover:-translate-y-1"
                                    >é–‹å§‹åœå¦</button>
                                </div>
                            )}

                            {step === 1 && (
                                <div className="text-center animate-in">
                                    <h2 className="text-lg mb-10 text-slate-500">å•é¡Œï¼š{question}</h2>
                                    <div className="flex flex-col items-center mb-12">
                                        <div className="bg-slate-50 p-8 rounded-2xl border border-slate-100">
                                            {[...Array(6)].map((_, i) => (
                                                <div key={i}>
                                                    {currentLines[5-i] ? renderLine(currentLines[5-i]) : (
                                                        <div className="w-32 h-4 mb-2 bg-slate-200/30 border border-dashed border-slate-300 rounded-sm" />
                                                    )}
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    <button 
                                        onClick={rollCoins}
                                        disabled={isRolling}
                                        className={`w-28 h-28 rounded-full border-4 border-slate-900 font-bold text-xl transition-all ${isRolling ? 'opacity-50 scale-95' : 'hover:scale-110 active:scale-95'}`}
                                    >
                                        {isRolling ? '...' : 'æŠ•æ“²'}
                                    </button>
                                    <p className="mt-6 text-slate-400 text-sm">å·²å¾— {currentLines.length} çˆ»ï¼Œå°šéœ€ {6 - currentLines.length} çˆ»</p>
                                </div>
                            )}

                            {step === 2 && (
                                <div className="space-y-10 animate-in">
                                    <div className="grid md:grid-cols-2 gap-8">
                                        <div className="text-center">
                                            <span className="inline-block bg-slate-100 text-slate-500 text-xs px-3 py-1 rounded-full mb-3 font-bold">æœ¬å¦ (ç¾ç‹€)</span>
                                            <h3 className="text-3xl font-bold mb-4">{originalGua.name}</h3>
                                            <div className="flex flex-col items-center p-6 bg-slate-50 rounded-2xl">
                                                {[...currentLines].reverse().map((l, i) => renderLine(l))}
                                            </div>
                                        </div>
                                        <div className="text-center">
                                            <span className="inline-block bg-orange-100 text-orange-600 text-xs px-3 py-1 rounded-full mb-3 font-bold">è®Šå¦ (ç™¼å±•)</span>
                                            <h3 className="text-3xl font-bold text-orange-900 mb-4">{changedGua.name}</h3>
                                            <div className="flex flex-col items-center p-6 bg-orange-50 rounded-2xl">
                                                {[...currentLines].reverse().map((l, i) => {
                                                    const changedVal = (l === 6) ? 7 : (l === 9) ? 8 : l;
                                                    return renderLine(changedVal, true);
                                                })}
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-slate-900 text-slate-200 p-8 rounded-3xl shadow-lg border border-slate-800">
                                        <h4 className="text-lg font-bold mb-4 flex items-center gap-2 text-white">
                                            <span className="text-2xl">ğŸ”®</span> è©³è§£å»ºè­°
                                        </h4>
                                        <div className="text-md leading-relaxed whitespace-pre-wrap font-sans">
                                            {isAnalysing ? "æ­£åœ¨åƒé€å¤©æ©Ÿï¼Œè«‹ç¨å€™..." : aiAnalysis}
                                        </div>
                                    </div>

                                    <button 
                                        onClick={() => {setStep(0); setCurrentLines([]); setAiAnalysis('');}}
                                        className="block mx-auto text-slate-400 hover:text-slate-900 transition-colors"
                                    >é‡æ–°æå•åœå¦</button>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

<p><a href="index.html">å›åˆ°é¦–é </a></p>
