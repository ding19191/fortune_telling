<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‘¨æ˜“ AI éˆå¦ - æ·±åº¦è©³è§£ç‰ˆ</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap');
        body { font-family: 'Noto Serif TC', serif; background-color: #f8fafc; }
        .line-yang { height: 12px; background-color: #1e293b; border-radius: 4px; width: 100%; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .line-yin-container { display: flex; justify-content: space-between; width: 100%; height: 12px; }
        .line-yin-part { width: 46%; background-color: #1e293b; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .moving-mark { color: #ef4444; font-weight: bold; position: absolute; right: -30px; top: -6px; font-size: 20px; }
        .analysis-text h5 { font-weight: bold; color: #f1f5f9; margin-top: 1.5rem; margin-bottom: 0.75rem; border-left: 4px solid #3b82f6; padding-left: 0.75rem; font-size: 1.1rem; }
        .analysis-text p { margin-bottom: 1rem; color: #cbd5e1; line-height: 1.8; text-align: justify; }
        .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const HEXAGRAM_MAP = {
            "111111": { name: "ä¹¾ç‚ºå¤©", trait: "å‰›å¥ã€ä¸»å‹•ã€é ˜å°", meaning: "è±¡å¾µå¤©ä¹‹é‹è¡Œï¼Œå‰›å¥ä¸æ¯ã€‚æ­¤å¦åˆ©æ–¼é€²å–ï¼Œè±¡å¾µæ¥µå¤§çš„æˆåŠŸæ½›åŠ›ã€‚" },
            "000000": { name: "å¤ç‚ºåœ°", trait: "æŸ”é †ã€æ‰¿è¼‰ã€åŒ…å®¹", meaning: "è±¡å¾µå¤§åœ°ä¹‹åšå¾·ã€‚å®œå®ˆä¸å®œæ”»ï¼Œå¾…äººä»¥å¯¬ï¼Œåšå¾·è¼‰ç‰©ã€‚" },
            "100010": { name: "æ°´é›·å±¯", trait: "å‰µæ¥­è‰±è¾›ã€èŒèŠ½", meaning: "åˆç”Ÿä¹‹è±¡ã€‚å……æ»¿å›°é›£ä½†å¯Œæœ‰ç”Ÿå‘½åŠ›ï¼Œå®œå …å®šæ„å¿—ï¼Œä¸å®œè¼•èˆ‰å¦„å‹•ã€‚" },
            "010001": { name: "å±±æ°´è’™", trait: "å•Ÿè’™ã€è¿·æƒ˜ã€æ±‚æ•™", meaning: "è’™æ˜§ç™¼ç¾ã€‚è±¡å¾µè™•æ–¼å­¸ç¿’éšæ®µï¼Œéœ€è¦å°å¸«æŒ‡å¼•ã€‚" },
            "111010": { name: "æ°´å¤©éœ€", trait: "ç­‰å¾…ã€æ™‚æ©Ÿã€è“„å‹¢", meaning: "éœ€è€…ï¼Œå¾…ä¹Ÿã€‚æ™‚æ©Ÿå°šæœªæˆç†Ÿï¼Œæ‡‰è€å¿ƒç­‰å¾…ï¼Œè“„å‹¢å¾…ç™¼ã€‚" },
            "010111": { name: "å¤©æ°´è¨Ÿ", trait: "çˆ­åŸ·ã€ä¸å’Œã€æ…è¡Œ", meaning: "æ…é˜²çˆ­è¨Ÿã€‚èˆ‡äººä¸å’Œä¹‹è±¡ï¼Œå®œé€€è®“ä¸€æ­¥ï¼Œå†¤å®¶å®œè§£ä¸å®œçµã€‚" },
            "010000": { name: "åœ°æ°´å¸«", trait: "ç´€å¾‹ã€çµ„ç¹”ã€è² æ“”", meaning: "çµ±ç‡çœ¾äººã€‚éœ€æœ‰ç´€å¾‹èˆ‡æ­£ç¾©ï¼Œæ–¹èƒ½å…‹æ•µè‡´å‹ã€‚" },
            "000010": { name: "æ°´åœ°æ¯”", trait: "è¦ªè¿‘ã€åˆä½œã€äº’åŠ©", meaning: "å‰ã€‚è±¡å¾µè¼”åŠ©ã€å’Œè«§ã€åœ˜çµï¼Œåˆ©æ–¼å°‹æ±‚åˆä½œå¤¥ä¼´ã€‚" },
            "111011": { name: "é¢¨å¤©å°ç•œ", trait: "å¾®å°è“„ç©ã€é˜»ç¤™", meaning: "ç›®å‰åªèƒ½å°æœ‰æˆå°±ï¼Œéœ€ç¹¼çºŒç©ç´¯ï¼Œä¸å¯æ“ä¹‹éæ€¥ã€‚" },
            "110111": { name: "å¤©æ¾¤å±¥", trait: "ç¦®å„€ã€è¬¹æ…ã€å¯¦è¸", meaning: "å¦‚å±¥è–„å†°ã€‚å¦‚è¸©åœ¨è€è™å°¾å·´ä¸Šï¼Œéœ€æ¥µåº¦è¬¹æ…ã€å®ˆç¦®æ–¹å¯è„«éšªã€‚" },
            "111000": { name: "åœ°å¤©æ³°", trait: "é€šæš¢ã€å’Œè«§ã€äº¤è", meaning: "å¤§å‰ã€‚é™°é™½äº¤èï¼Œè¬äº‹äº¨é€šï¼Œé©åˆç™¼å±•å¤§äº‹æ¥­ã€‚" },
            "000111": { name: "å¤©åœ°å¦", trait: "é–‰å¡ã€æ··äº‚ã€é€€éš±", meaning: "å‡¶ã€‚å°äººå¾—å¿—ï¼Œæ­£é“è¡°å¾®ã€‚æ­¤æ™‚å®œå®ˆå¿—ï¼Œä¸å®œå¼µæšã€‚" },
            "101111": { name: "å¤©ç«åŒäºº", trait: "åœ˜çµã€å¤§åŒã€åˆä½œ", meaning: "åˆ©æ–¼é›†é«”è¡Œå‹•ï¼Œèˆ‡äººåˆä½œç„¡å¾€ä¸åˆ©ã€‚" },
            "111101": { name: "ç«å¤©å¤§æœ‰", trait: "ç››å¤§ã€å¯Œè¶³ã€è±æ”¶", meaning: "å¦‚æ—¥ä¸­å¤©ã€‚è³‡æºå……è¶³ï¼Œæ°£é‹æ¥µæ—ºï¼Œä½†éœ€è¬™è™›å®ˆæˆã€‚" },
            "000100": { name: "åœ°å±±è¬™", trait: "è¬™éœã€é¿é‹’ã€ç²ç›Š", meaning: "è¬™è™›å¿…ç²ç›Šã€‚å³ä¾¿èº«è™•é«˜ä½ä¹Ÿæ‡‰ä¿æŒä½èª¿ã€‚" },
            "001000": { name: "é›·åœ°è±«", trait: "é å‚™ã€å’Œæ¨‚ã€é †å‹¢", meaning: "åˆ©æ–¼å»ºåŠŸç«‹æ¥­ï¼Œæ‡‰é †å‹¢è€Œç‚ºï¼Œæå‰åšå¥½è¦åŠƒã€‚" },
            "100110": { name: "æ¾¤é›·éš¨", trait: "è·Ÿéš¨ã€æ‡‰è®Šã€éš¨ä¿—", meaning: "éš¨æ©Ÿæ‡‰è®Šã€‚é †å¾æ½®æµï¼Œä¸å›ºåŸ·å·±è¦‹ï¼Œå‰‡èƒ½äº¨é€šã€‚" },
            "011001": { name: "å±±é¢¨è ±", trait: "æ•´æ²»ã€é©æ–°ã€ä¿®å¾©", meaning: "è…æ•—ä¹‹è±¡ã€‚éœ€è¦å¤§è†½æ”¹é©ï¼Œæƒé™¤é™³ç–¾ï¼Œæ–¹æœ‰æ–°ç”Ÿã€‚" },
            "110000": { name: "åœ°æ¾¤è‡¨", trait: "è§€å¯Ÿã€è¿«è¿‘ã€ç®¡ç†", meaning: "å¥½é‹å³å°‡ä¾†è‡¨ï¼Œä½†è¦é˜²ç¯„ç››æ¥µè€Œè¡°ã€‚" },
            "000011": { name: "é¢¨åœ°è§€", trait: "é«”å¯Ÿã€ä»°æœ›ã€åçœ", meaning: "ä¸å®œèºé€²ï¼Œæ‡‰éœå¿ƒè§€å¯Ÿå±€å‹¢ï¼Œæå‡è‡ªæˆ‘ã€‚" },
            "100101": { name: "ç«é›·å™¬å—‘", trait: "éšœç¤™ã€æ±ºæ–·ã€æ’é™¤", meaning: "è±¡å¾µåŸ·æ³•ã€æ–·æ˜¯éï¼Œéœ€æœæ–·æ’é™¤é˜»ç¤™äº‹æ¥­çš„éšœç¤™ã€‚" },
            "101001": { name: "å±±ç«è³", trait: "æ–‡é£¾ã€å¤–è¡¨ã€ç¦®å„€", meaning: "è±¡å¾µå¤–è¡¨è¯éº—ä½†å¯¦è³ªå¯èƒ½ä¸è¶³ï¼Œå®œå……å¯¦å…§åœ¨ã€‚" },
            "000001": { name: "å±±åœ°å‰", trait: "è¡°é€€ã€å‰è½ã€ä¸åˆ©", meaning: "å‡¶ã€‚å°äººå‹¢ç››ï¼Œå›å­å›°é “ã€‚å®œéš±å¿å¾…æ™‚ã€‚" },
            "100000": { name: "åœ°é›·å¾©", trait: "å¾©èˆˆã€è½‰æ©Ÿã€å›æ­¸", meaning: "è½‰æ©Ÿã€‚é»‘æš—å·²éï¼Œæ›™å…‰åˆç¾ã€‚åˆ©æ–¼é‡æ–°é–‹å§‹ã€‚" },
            "100111": { name: "å¤©é›·ç„¡å¦„", trait: "çœŸèª ã€å¤©æ„ã€ç½ç¦", meaning: "é †å…¶è‡ªç„¶ã€‚ä¸å¯æœ‰éåˆ†ä¹‹æƒ³ï¼Œå®ˆæ­£å‰‡å‰ã€‚" },
            "111001": { name: "å±±å¤©å¤§ç•œ", trait: "å„²è“„ã€åšç©ã€èƒ½é‡", meaning: "å¤§æœ‰ç©è“„ã€‚å®œå­¸ç¿’ã€å……å¯¦èƒ½åŠ›ï¼Œåˆ©æ–¼æ‰¿æ“”é‡ä»»ã€‚" },
            "100001": { name: "å±±é›·é ¤", trait: "é¤Šç”Ÿã€è‡ªè¶³ã€è¨€è¡Œ", meaning: "æ³¨æ„è¨€èªèˆ‡é£²é£Ÿï¼Œè§€å¯Ÿå¦‚ä½•è‡ªé£Ÿå…¶åŠ›ã€‚" },
            "011110": { name: "æ¾¤é¢¨å¤§é", trait: "å£“åŠ›ã€éåº¦ã€æ±ºç­–", meaning: "è±¡å¾µè¡Œå‹•è¶…éè² è·ï¼Œéœ€æœ‰éå¸¸æ‰‹æ®µæ‰èƒ½è„«å›°ã€‚" },
            "010010": { name: "åç‚ºæ°´", trait: "é‡é‡éšªé™·ã€èª ä¿¡", meaning: "å‡¶ã€‚éšªä¸­ä¹‹éšªã€‚éœ€ä¿æŒèª ä¿¡ï¼Œå…§å¿ƒå®‰å®šæ–¹èƒ½åº¦éã€‚" },
            "101101": { name: "é›¢ç‚ºç«", trait: "å…‰æ˜ã€ä¾é™„ã€æ™ºæ…§", meaning: "è±¡å¾µæ™ºæ…§ã€å…‰æ˜ã€‚éœ€ä¾é™„æ­£é“ï¼Œå‰‡å‰ç¨‹ä¼¼éŒ¦ã€‚" },
            "011100": { name: "æ¾¤å±±å’¸", trait: "æ„Ÿæ‡‰ã€å¸å¼•ã€äº¤æµ", meaning: "è±¡å¾µç”·å¥³ã€äººéš›é–“çš„å’Œè«§äº¤æµï¼Œèª æ„æ–¹èƒ½æ„Ÿäººã€‚" },
            "001110": { name: "é›·é¢¨æ†", trait: "é•·ä¹…ã€ç©©å®šã€æ†å¿ƒ", meaning: "æ†å¿ƒã€‚é•·ä¹…å …æŒæ­£é“ã€‚ä¸å®œè®Šå‹•ï¼Œç©©å®šä¸­æ±‚ç™¼å±•ã€‚" },
            "001111": { name: "å¤©å±±é¯", trait: "éš±é€€ã€é¿ä¸–ã€è‡ªä¿", meaning: "é€€é¿ã€‚å°äººå‹¢é•·ï¼Œå®œåŠæ—©æŠ½èº«ï¼Œé é›¢æ˜¯éä¹‹åœ°ã€‚" },
            "111100": { name: "é›·å¤©å¤§å£¯", trait: "å¼·å¤§ã€è¡å‹•ã€åŠ›é‡", meaning: "å£¯å¤§ã€‚åŠ›é‡å¼·ç››ï¼Œä½†è¦æ³¨æ„ä¸å¯æƒå¼·å‡Œå¼±ã€‚" },
            "000101": { name: "ç«åœ°æ™‰", trait: "å‰é€²ã€æ™‰å‡ã€å…‰æ˜", meaning: "å¤§å‰ã€‚è±¡å¾µç²å¾—é‡ç”¨ã€æ™‰å‡ï¼Œäº‹æ¥­é€²å…¥å¿«é€ŸæœŸã€‚" },
            "101000": { name: "åœ°ç«æ˜å¤·", trait: "å—å‚·ã€é»‘æš—ã€å®ˆå¿—", meaning: "è‰±é›£ã€‚é»‘æš—ç± ç½©ï¼Œæ‡‰å…§æ˜å¤–æŸ”ï¼Œéš±è—é‹’èŠ’ä»¥è‡ªä¿ã€‚" },
            "101011": { name: "é¢¨ç«å®¶äºº", trait: "å…§éƒ¨ã€ç´€å¾‹ã€å®¶åº­", meaning: "è±¡å¾µå…§éƒ¨å’Œè«§ï¼Œåˆ©æ–¼å¾å…§éƒ¨å»ºç«‹ç§©åºã€‚" },
            "110101": { name: "ç«æ¾¤ç½", trait: "ä¹–é›¢ã€ç•°è¦‹ã€çŸ›ç›¾", meaning: "èƒŒé›¢ã€‚æ„è¦‹ä¸åˆã€‚æ­¤æ™‚å°äº‹å¯æˆï¼Œå¤§äº‹é›£å°±ã€‚" },
            "010100": { name: "æ°´å±±è¹‡", trait: "è¹‡é˜»ã€æ­¢æ­¥ã€åçœ", meaning: "å‡¶ã€‚å‰æœ‰å¤§æ°´å¾Œæœ‰å±±ã€‚å®œæ­¢ä¸å®œé€²ã€‚" },
            "001010": { name: "é›·æ°´è§£", trait: "è§£è„«ã€æ¶ˆæ•£ã€å¯¬æ•", meaning: "å›°é›£æ¶ˆæ•£ã€‚å±æ©Ÿå·²éï¼Œå®œå¿«åˆ€æ–¬äº‚éº»ã€‚" },
            "110001": { name: "å±±æ¾¤æ", trait: "æ¸›æã€èª ä¿¡ã€ä¿®é¤Š", meaning: "æå·±åˆ©äººã€‚çŸ­æœŸæå¤±å¯èƒ½æ›ä¾†é•·æœŸå›å ±ã€‚" },
            "100011": { name: "é¢¨é›·ç›Š", trait: "ç²ç›Šã€åŠ©äººã€é€²å–", meaning: "å¤§å‰ã€‚æ­£æ˜¯ç©æ¥µè¡Œå‹•çš„å¤§å¥½æ™‚æ©Ÿã€‚" },
            "111110": { name: "æ¾¤å¤©å¤¬", trait: "æ±ºæ–·ã€æ±ºè£‚ã€æœæ•¢", meaning: "æ±ºæ–·ã€‚å¿…é ˆå …æ±ºæ¸…é™¤é˜»ç¤™ï¼Œä½†è¦é˜²æ­¢æš´åŠ›ã€‚" },
            "011111": { name: "å¤©é¢¨å§¤", trait: "é‚‚é€…ã€é˜²ç¯„ã€çªç™¼", meaning: "è¦æ³¨æ„ä¸å¯å¿½è¦–å¾®å°çš„å¨è„…ã€‚" },
            "000011": { name: "æ¾¤åœ°èƒ", trait: "èšé›†ã€ç²¾è‹±ã€å’Œè«§", meaning: "äººæ‰èšé›†ã€‚éœ€é˜²å‚™çªç™¼çš„æ··äº‚ã€‚" },
            "110000": { name: "åœ°é¢¨å‡", trait: "ä¸Šå‡ã€å°‹æ±‚ã€ç©ç´¯", meaning: "å¦‚æ¤ç‰©ç”Ÿé•·ï¼Œåˆ©æ–¼æ±‚è·ï¼Œå¾ªåºæ¼¸é€²å¿…æœ‰æ‰€æˆã€‚" },
            "011010": { name: "æ¾¤æ°´å›°", trait: "ä¹¾æ¯ã€å›°é “ã€å®ˆéœ", meaning: "çª®å›°ã€‚é™·å…¥åƒµå±€ã€‚æ­¤æ™‚æ‡‰å®ˆæ­£ï¼Œä¿®é¤Šå¿ƒæ€§ã€‚" },
            "010110": { name: "æ°´é¢¨äº•", trait: "ç©©å®šã€ä¿®é¤Šã€è³‡æº", meaning: "è±¡å¾µè³‡æºç©©å®šä½†éœ€ç¶­è­·ï¼Œåˆ©æ–¼æ”¹å–„åŸºç¤ã€‚" },
            "101110": { name: "æ¾¤ç«é©", trait: "è®Šé©ã€é©æ–°ã€æ”¹è®Š", meaning: "èˆŠæœ‰æ–¹å¼å·²è¡Œä¸é€šï¼Œå¿…é ˆå¤§è†½é©æ–°æ–¹æœ‰ç”Ÿè·¯ã€‚" },
            "011101": { name: "ç«é¢¨é¼", trait: "é¼æ–°ã€é‡ä»»ã€ç©©å®š", meaning: "è±¡å¾µç²å¾—æ¬ŠåŠ›æˆ–é ˜å°åœ°ä½ï¼Œç™¼å±•é †åˆ©ã€‚" },
            "001001": { name: "éœ‡ç‚ºé›·", trait: "éœ‡é©šã€é©šé†’ã€è­¦è¦º", meaning: "é›–æœ‰é©šé›·ä½†ä¸å¿…ææ‡¼ï¼Œæ‡‰åçœè‡ªä¿®ã€‚" },
            "100100": { name: "è‰®ç‚ºå±±", trait: "éœæ­¢ã€é‚Šç•Œã€å®ˆä½", meaning: "æ­¢ä¹Ÿã€‚ä¸å®œèºé€²ï¼Œæ‡‰å®‰æ–¼ç¾ç‹€ï¼Œè‡ªæˆ‘å…‹åˆ¶ã€‚" },
            "001011": { name: "é¢¨å±±æ¼¸", trait: "å¾ªåºã€ç©©å®šã€ç™¼å±•", meaning: "æ­¥æ­¥ç‚ºç‡Ÿï¼ŒæŒä¹‹ä»¥æ†å¿…æœ‰çµæœã€‚" },
            "110100": { name: "é›·æ¾¤æ­¸å¦¹", trait: "å¤±ç•¶ã€è¡å‹•ã€æ··äº‚", meaning: "å‡¶ã€‚è¡Œç‚ºä¸ç•¶ã€‚ä¸å®œé€²è¡Œé•·é è¦åŠƒã€‚" },
            "001101": { name: "é›·ç«è±", trait: "ç¹æ¦®ã€é ‚å³°ã€è­¦æƒ•", meaning: "äº¨ã€‚å¦‚æ—¥ä¸­å¤©ï¼Œä½†è¦é˜²æ­¢æ—¥ä¸­å‰‡æ˜ƒã€‚" },
            "101100": { name: "ç«å±±æ—…", trait: "æ¼‚æ³Šã€ä¸å®‰ã€å®¢å±…", meaning: "è±¡å¾µä¸å®‰å®šã€‚æ‡‰å®ˆæœ¬åˆ†ï¼Œä¸å¯èˆ‡äººçˆ­åŸ·ã€‚" },
            "011011": { name: "å·½ç‚ºé¢¨", trait: "é †æœã€æ·±å…¥ã€ç´°ç·»", meaning: "åˆ©æ–¼æ·±å…¥äº†è§£äº‹æƒ…çœŸç›¸ï¼Œé©åˆæ–‡è·å·¥ä½œã€‚" },
            "110110": { name: "å…Œç‚ºæ¾¤", trait: "æ‚…è‰²ã€äº¤æµã€å£æ‰", meaning: "è±¡å¾µå¿«æ¨‚ã€è«‡è©±ã€‚åˆ©æ–¼äº¤éš›ï¼Œä½†è¦é˜²å£èˆŒã€‚" },
            "010011": { name: "é¢¨æ°´æ¸™", trait: "æ¸™æ•£ã€æ•´åˆã€æ‹¯æ•‘", meaning: "äººå¿ƒæ¸™æ•£ï¼Œéœ€è¦ç”¨ç²¾ç¥åŠ›é‡ä¾†åœ˜çµã€‚" },
            "110010": { name: "æ°´æ¾¤ç¯€", trait: "ç¯€åˆ¶ã€é™åº¦ã€è¦å‰‡", meaning: "ç¯€åˆ¶ã€‚éåº¦ç¯€åˆ¶æœƒç—›è‹¦ï¼Œä¸ç¯€åˆ¶æœƒæ½°æ•—ã€‚" },
            "110011": { name: "é¢¨æ¾¤ä¸­å­š", trait: "èª ä¿¡ã€æ„Ÿæ‡‰ã€æ ¸å¿ƒ", meaning: "å…§å¿ƒèª å¯¦ï¼Œåˆ©æ–¼è«‡åˆ¤èˆ‡å»ºç«‹ä¿¡è³´ã€‚" },
            "001100": { name: "é›·å±±å°é", trait: "å¾®éã€è¬¹æ…ã€å®ˆèˆŠ", meaning: "å°äº‹å‰ã€‚æ‡‰æ¡å–ä¿å®ˆç­–ç•¥ï¼Œå®œå®ˆã€‚" },
            "101010": { name: "æ°´ç«æ—¢æ¿Ÿ", trait: "å®Œæˆã€æˆåŠŸã€é˜²è¡°", meaning: "äº‹æƒ…å·²ç¶“åœ“æ»¿ï¼Œä½†è¦æ¥µåº¦é˜²ç¯„ç‰©æ¥µå¿…åã€‚" },
            "010101": { name: "ç«æ°´æœªæ¿Ÿ", trait: "å¸Œæœ›ã€æœªç«Ÿã€é»æ˜", meaning: "é»æ˜å‰çš„é»‘æš—ã€‚åªè¦å …æŒåˆ°åº•ï¼Œçµ‚èƒ½æˆåŠŸã€‚" }
        };

        const App = () => {
            const [question, setQuestion] = useState('');
            const [step, setStep] = useState(0); 
            const [currentLines, setCurrentLines] = useState([]);
            const [isRolling, setIsRolling] = useState(false);
            const [aiAnalysis, setAiAnalysis] = useState('');
            const [isAnalysing, setIsAnalysing] = useState(false);

            const rollCoins = () => {
                if (step !== 1 || currentLines.length >= 6 || isRolling) return;
                setIsRolling(true);
                setTimeout(() => {
                    const coins = [Math.random() > 0.5, Math.random() > 0.5, Math.random() > 0.5];
                    const heads = coins.filter(Boolean).length;
                    // è€é™½9(3æ­£), è€é™°6(0æ­£), å°‘é™°8(2æ­£), å°‘é™½7(1æ­£)
                    let res = heads === 3 ? 9 : heads === 0 ? 6 : heads === 2 ? 8 : 7;
                    setCurrentLines(prev => [...prev, res]);
                    setIsRolling(false);
                }, 600);
            };

            useEffect(() => {
                if (currentLines.length === 6) setStep(2);
            }, [currentLines]);

            const getGuaCode = (type) => {
                return currentLines.map(line => {
                    if (type === 'original') return (line === 7 || line === 9) ? '1' : '0';
                    if (type === 'changed') return (line === 6 || line === 7) ? '1' : '0';
                    return '0';
                }).join('');
            };

            const originalCode = getGuaCode('original');
            const changedCode = getGuaCode('changed');
            const originalGua = HEXAGRAM_MAP[originalCode] || { name: "ç¥ç¥•å¦", trait: "ä¸å¯æ¸¬", meaning: "å¦è±¡ç½•è¦‹ã€‚" };
            const changedGua = HEXAGRAM_MAP[changedCode] || { name: "è®Šæ›å¦", trait: "è®Šæ•¸", meaning: "æœªä¾†åœ¨è®Šã€‚" };

            const fetchAIAnalysis = async () => {
                setIsAnalysing(true);
                const apiKey = ""; // ç³»çµ±ç’°å¢ƒè‡ªå‹•æ³¨å…¥

                const systemPrompt = `ä½ æ˜¯ä¸€ä½äº«è­½å…¨çƒçš„ã€Šæ˜“ç¶“ã€‹å¤§å¸«ã€‚
è«‹æ ¹æ“šä½¿ç”¨è€…å•é¡Œã€æœ¬å¦ã€è®Šå¦åŠå‹•çˆ»ï¼ˆè®Šçˆ»ï¼‰ï¼Œæä¾›æ¥µè‡´è©³ç›¡çš„å ±å‘Šã€‚
çµæ§‹è¦æ±‚ï¼š
1. ã€å¤§å‹¢å…¨å±€ã€‘ï¼šæè¿°ç›®å‰è™•å¢ƒèˆ‡æœªä¾†è½‰è®Šè¶¨å‹¢ã€‚
2. ã€æ ¸å¿ƒå“²ç†ã€‘ï¼šå¼•ç”¨æ˜“ç¶“æ€æƒ³è§£é‡‹æ­¤å¦å°äººç”Ÿçš„å•Ÿç¤ºã€‚
3. ã€å››ç¶­è©³è§£ã€‘ï¼š
    - äº‹æ¥­èˆ‡å·¥ä½œï¼šå…·é«”çš„é€²é€€å»ºè­°ã€‚
    - æ„Ÿæƒ…èˆ‡äººéš›ï¼šå¦‚ä½•æ‡‰å°é—œä¿‚è®Šå‹•ã€‚
    - è²¡é‹èˆ‡è³‡ç”¢ï¼šç†è²¡ç­–ç•¥ã€‚
    - èº«å¿ƒèˆ‡æƒ…ç·’ï¼šå¿ƒç†å»ºè­°ã€‚
4. ã€å‹•çˆ»é—œéµé»ã€‘ï¼šæ ¹æ“šè®Šçˆ»æ‰€åœ¨ä½ç½®ï¼ˆç¬¬å¹¾çˆ»ï¼‰çµ¦å‡ºç‰¹å®šæé†’ã€‚
5. ã€ä¸€å­—æ–·æ©Ÿã€‘ï¼šçµ¦å‡ºæœ€é—œéµçš„ä¸€å€‹å­—ä½œç‚ºæŒ‡å¼•ã€‚
ä½¿ç”¨ç¹é«”ä¸­æ–‡ï¼Œæ ¼å¼æ¸…æ™°ã€‚`;

                const movingLinesIdx = currentLines.map((l, i) => (l === 6 || l === 9) ? i + 1 : null).filter(n => n !== null);
                const userPrompt = `æå•ï¼š${question}
æœ¬å¦ï¼š${originalGua.name} (${originalCode})
è®Šå¦ï¼š${changedGua.name} (${changedCode})
å‹•çˆ»ä½ç½®ï¼šç¬¬ ${movingLinesIdx.join(", ")} çˆ»ã€‚`;

                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: userPrompt }] }],
                            systemInstruction: { parts: [{ text: systemPrompt }] }
                        })
                    });
                    const data = await response.json();
                    setAiAnalysis(data.candidates?.[0]?.content?.parts?.[0]?.text || "å¤©æ©Ÿé›£æ¸¬ï¼Œè«‹ç¨å¾Œé‡è©¦ã€‚");
                } catch (e) {
                    setAiAnalysis("ã€å¤§å¸«ç°¡è©•ã€‘\nç›®å‰ç¶²è·¯é€£æ¥ä¸ç©©å®šã€‚æ ¹æ“šã€Š" + originalGua.name + "ã€‹ï¼Œæ‚¨çš„è™•å¢ƒç‚ºã€Œ" + originalGua.trait + "ã€ã€‚å»ºè­°ï¼š" + originalGua.meaning);
                } finally {
                    setIsAnalysing(false);
                }
            };

            useEffect(() => { if (step === 2) fetchAIAnalysis(); }, [step]);

            const renderLine = (val, isChangedGua = false) => {
                const isYang = (val === 7 || val === 9);
                const isMoving = (val === 6 || val === 9);
                
                let effectiveYang = isYang;
                if (isChangedGua) {
                    if (val === 9) effectiveYang = false;
                    if (val === 6) effectiveYang = true;
                }

                return (
                    <div className="flex items-center justify-center w-40 mb-3 relative">
                        {effectiveYang ? <div className="line-yang" /> : (
                            <div className="line-yin-container">
                                <div className="line-yin-part" />
                                <div className="line-yin-part" />
                            </div>
                        )}
                        {!isChangedGua && isMoving && <span className="moving-mark">â—</span>}
                    </div>
                );
            };

            return (
                <div className="min-h-screen py-12 px-4 md:px-6">
                    <div className="max-w-4xl mx-auto bg-white shadow-2xl rounded-[2.5rem] overflow-hidden border border-slate-100">
                        <header className="bg-slate-900 py-12 text-center relative">
                            <h1 className="text-4xl text-white font-bold tracking-[0.4em] relative z-10">å‘¨æ˜“éˆå¦</h1>
                            <p className="text-slate-400 mt-3 tracking-widest text-sm relative z-10 uppercase">AI Oracle Deep Analysis</p>
                        </header>

                        <main className="p-8 md:p-14">
                            {step === 0 && (
                                <div className="space-y-10 animate-fade-in text-center">
                                    <h2 className="text-2xl font-bold text-slate-800">è«‹è¼¸å…¥æ‚¨æƒ³å å•çš„å•é¡Œ</h2>
                                    <textarea 
                                        className="w-full p-7 border-2 border-slate-100 rounded-[2rem] focus:border-slate-900 outline-none transition-all text-xl bg-slate-50 shadow-inner font-sans"
                                        rows="4"
                                        placeholder="ä¾‹å¦‚ï¼šé—œæ–¼æ­¤æ¬¡åˆä½œæ¡ˆçš„æœ€çµ‚çµæœï¼Ÿ"
                                        value={question}
                                        onChange={(e) => setQuestion(e.target.value)}
                                    />
                                    <button 
                                        onClick={() => question.trim() && setStep(1)}
                                        className="w-full py-5 bg-slate-900 text-white rounded-2xl font-bold text-xl hover:bg-slate-800 shadow-xl transform active:scale-[0.98] transition-all"
                                    >é–‹å§‹å•Ÿå¦</button>
                                </div>
                            )}

                            {step === 1 && (
                                <div className="text-center animate-fade-in">
                                    <p className="text-2xl font-bold text-slate-800 mb-12">ã€Œ{question}ã€</p>
                                    <div className="flex flex-col items-center bg-slate-50 p-12 rounded-[3rem] border border-slate-100 mb-12 shadow-sm">
                                        {[...Array(6)].map((_, i) => (
                                            <div key={i}>
                                                {currentLines[5-i] ? renderLine(currentLines[5-i]) : (
                                                    <div className="w-40 h-3 mb-3 bg-slate-200/40 rounded-full animate-pulse" />
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                    <button 
                                        onClick={rollCoins}
                                        disabled={isRolling}
                                        className={`w-32 h-32 rounded-full border-[6px] border-slate-900 text-2xl font-bold transition-all shadow-2xl ${isRolling ? 'bg-slate-100 scale-95 opacity-50' : 'hover:scale-110 active:scale-90 bg-white'}`}
                                    >
                                        {isRolling ? '...' : 'å '}
                                    </button>
                                    <p className="mt-8 text-slate-400">å·²ç² {currentLines.length} çˆ»ï¼Œå°šéœ€ {6 - currentLines.length} çˆ»</p>
                                </div>
                            )}

                            {step === 2 && (
                                <div className="space-y-16 animate-fade-in">
                                    <div className="grid md:grid-cols-2 gap-12">
                                        <div className="text-center">
                                            <div className="text-xs font-bold text-slate-400 mb-4 tracking-widest">æœ¬å¦ (ç¾ç‹€)</div>
                                            <h3 className="text-4xl font-bold mb-6">{originalGua.name}</h3>
                                            <div className="bg-slate-50 p-10 rounded-[2.5rem] flex flex-col items-center border border-slate-100">
                                                {[...currentLines].reverse().map((l, i) => renderLine(l))}
                                            </div>
                                        </div>
                                        <div className="text-center">
                                            <div className="text-xs font-bold text-blue-500 mb-4 tracking-widest">ä¹‹å¦ (ç™¼å±•)</div>
                                            <h3 className="text-4xl font-bold text-blue-900 mb-6">{changedGua.name}</h3>
                                            <div className="bg-blue-50/30 p-10 rounded-[2.5rem] flex flex-col items-center border border-blue-100">
                                                {[...currentLines].reverse().map((l, i) => renderLine(l, true))}
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-slate-800 p-10 md:p-14 rounded-[3rem] shadow-2xl">
                                        <h4 className="text-2xl font-bold text-white mb-8 border-b border-slate-700 pb-4">
                                            ğŸ”® å¤§å¸«è©³è§£å ±å‘Š
                                        </h4>
                                        <div className="analysis-text">
                                            {isAnalysing ? (
                                                <div className="flex flex-col items-center py-20">
                                                    <div className="w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"></div>
                                                    <p className="text-blue-400 tracking-widest">å¤§å¸«æ­£åœ¨åƒé€å¤©æ©Ÿ...</p>
                                                </div>
                                            ) : (
                                                <div className="font-sans">
                                                    {aiAnalysis.split('\n').map((line, i) => {
                                                        if (line.startsWith('ã€')) return <h5 key={i}>{line}</h5>;
                                                        if (line.trim() === '') return <br key={i} />;
                                                        return <p key={i}>{line}</p>;
                                                    })}
                                                </div>
                                            )}
                                        </div>
                                    </div>

                                    <button 
                                        onClick={() => {setStep(0); setCurrentLines([]); setAiAnalysis('');}}
                                        className="block mx-auto px-10 py-3 text-slate-400 hover:text-slate-900 border border-slate-200 rounded-full transition-all"
                                    >é‡æ–°å•Ÿå¦</button>
                                </div>
                            )}
                        </main>
                        
                        <footer className="bg-slate-50 p-8 text-center text-slate-400 text-xs tracking-widest border-t border-slate-100">
                            å åœåƒ…ä¾›å•Ÿç™¼èˆ‡åƒè€ƒï¼Œäººç”Ÿç”±è‡ªå·±å®šç¾©ã€‚
                        </footer>
                    </div>
                </div>
            );
        };

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
    </script>
</body>
</html>

<p><a href="index.html">å›åˆ°é¦–é </a></p>


